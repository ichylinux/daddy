#!/usr/bin/bash

function setup_dad() {
  sudo yum install -y git wget

  if [ `which mitamae` ]; then
    echo -e "`mitamae version` found.\ndaddy is ready."
  else
    echo "install mitamae"
    mkdir -p ./tmp
    pushd tmp
      rm -f mitamae-x86_64-linux.tar.gz
      wget https://github.com/itamae-kitchen/mitamae/releases/download/v1.5.6/mitamae-x86_64-linux.tar.gz
      tar zxf mitamae-x86_64-linux.tar.gz
      sudo mv mitamae-x86_64-linux /usr/local/bin/mitamae
    popd
  fi
}

function setup_environment() {
  mitamae local "itamae/environments/$1.rb"
}

case $1 in
  'env')
    setup_environment $2
    ;;
  'install')
    setup_dad
    ;;
esac
